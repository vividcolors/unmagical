parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"A5ip":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.typeOf=exports.pathToArray=exports.normalizeQuery=exports.normalizePathArray=exports.normalizePath=exports.isJsonValue=exports.isIntStr=exports.emptyObject=exports.emptyArray=exports.commonPath=exports.appendPath=void 0;const t=t=>{const e=+t;return e%1==0&&t===""+e};exports.isIntStr=t;const e=e=>{const r=e.split("/");for(let s=1;s<r.length;s++)t(r[s])&&(r[s]="*");return r.join("/")};exports.normalizePath=e;const r=(t,e)=>{if(""==e.charAt(0)||"/"==e.charAt(0))return e;if("0"===e)return t;const r=o(t);let s=e.split("/"),n=[],a=+s[0];return a>(n=r).length&&(a=n.length),n.splice(n.length-a,a),s.shift(),0==s.length&&0==n.length?"":"/"+n.concat(s).join("/")};exports.appendPath=r;const s=e=>{let r="";for(let s=0;s<e.length;s++)"number"==typeof e[s]||t(e[s])?r+="/*":r+="/"+e[s];return r};exports.normalizePathArray=s;const o=e=>{const r=e.split("/"),s=[];for(let o=1;o<r.length;o++)s.push(t(r[o])?+r[o]:r[o]);return s};exports.pathToArray=o;const n=t=>null===t?"null":Array.isArray(t)?"array":typeof t;exports.typeOf=n;const a={};exports.emptyObject=a;const p=[];exports.emptyArray=p;const l=t=>{switch(n(t)){case"null":case"number":case"boolean":case"string":case"object":case"array":return!0;default:return!1}};exports.isJsonValue=l;const c=(t,e)=>{const r=t.split("/"),s=e.split("/"),o=[];for(let n=0;n<r.length&&!(s.length<=n)&&r[n]==s[n];n++)o.push(r[n]);return o.join("/")};exports.commonPath=c;const i=(t,e)=>{const r={};for(let s in t)switch(n(s)){case"null":e||(r[s]="");break;case"boolean":r[s]=t[s]?"true":"false";break;case"number":r[s]=""+t[s];break;case"string":if(e&&""===t[s])break;r[s]=t[s]}return r};exports.normalizeQuery=i;
},{}],"c6ur":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=exports.test=exports.setSlot=exports.setPortal=exports.setExtra=exports.replace=exports.remove=exports.reduceDeep=exports.move=exports.mapDeep=exports.makeEnv=exports.isSame=exports.isEnv=exports.getSlot=exports.getExtra=exports.extract=exports.endUpdateTracking=exports.duplicate=exports.doReturn=exports.copy=exports.beginUpdateTracking=exports.add=void 0;var e=require("./utils"),t=require("ramda");const r=["ret","onPromiseThen"];function n(e,t){if(null==e)return{};var r,n,a=o(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function o(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}function a(e){var t=s(e,"string");return"symbol"==typeof t?t:String(t)}function s(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){i(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const p=(e,r)=>!e.length||(0,t.hasPath)(e,r),l=e=>(0,t.init)((0,t.init)(e)),d=t=>{const r={"@value":t,invalid:!1,message:""};switch((0,e.typeOf)(t)){case"object":case"array":break;case"number":case"integer":r.input=""+t,r.touched=!1;break;case"boolean":r.input=t?"true":"false",r.touched=!1;break;case"null":r.input="",r.touched=!1;break;case"string":r.input=t,r.touched=!1}return r},f=t=>{const r=t=>{switch((0,e.typeOf)(t)){case"array":const n=[];for(let e=0;e<t.length;e++)n[e]=r(t[e]);return d(n);case"object":const o={};for(let e in t)o[e]=r(t[e]);return d(o);default:return d(t)}};return r(t)},h=t=>{const r=t["@value"];switch((0,e.typeOf)(r)){case"array":const t=[];for(let e=0;e<r.length;e++)t[e]=h(r[e]);return t;case"object":const n={};for(let e in r)n[e]=h(r[e]);return n;default:return r}},v=(e,t,r,n)=>{return{tree:f(e),trackUpdate:n,updatePoint:n?[]:null,schemaDb:t,validate:r,extra:{}}};exports.makeEnv=v;const w=(e,t)=>e.tree===t.tree&&e.extra===t.extra;exports.isSame=w;const y=t=>{const r=t.split("/"),n=[];for(let o=1;o<r.length;o++)n.push("@value"),n.push((0,e.isIntStr)(r[o])?+r[o]:r[o]);return n},P=e=>{let t="";for(let r=0;r<e.length;r+=2)t+="/"+e[r+1];return t},x=(e,t)=>{if(null===e)return t;if(null===t)return e;const r=[];for(let n=0;n<e.length&&!(n>=t.length)&&e[n+1]===t[n+1];n+=2)r.push(e[n]),r.push(e[n+1]);return r},b=e=>c(c({},e),{},{trackUpdate:!0});exports.beginUpdateTracking=b;const g=e=>{const t=e.updatePoint?P(e.updatePoint):null;return console.log("update occurred at "+JSON.stringify(t)),[t,c(c({},e),{},{trackUpdate:!1,updatePoint:null})]};exports.endUpdateTracking=g;const m=(e,t)=>p(y(e),t.tree);exports.test=m;const O=(e,r)=>{const n=y(e),o=(0,t.path)(n,r.tree);if(!o)throw new Error("extract/1: not found: "+e);return h(o)};exports.extract=O;const E=(e,r)=>{const n=y(e),o=(0,t.path)(n,r.tree);if(!o)throw new Error("getSlot/1: not found: "+e);return o};exports.getSlot=E;const j=(r,n,o)=>{const a=y(r),s=(0,t.path)(a,o.tree);if(!s)throw new Error("setSlot/1: not found: "+r);switch((0,e.typeOf)(s["@value"])){case"null":case"boolean":case"number":case"string":case"undefined":break;default:throw new Error("setSlot/2: not a scalar: "+r)}const u=(0,t.assocPath)(a,n,o.tree),i=o.trackUpdate?x(o.updatePoint,a):o.updatePoint;return c(c({},o),{},{tree:u,updatePoint:i})};exports.setSlot=j;const k=(r,n,o)=>{const a=y(r),s=l(a),u=(0,t.last)(a),i=(0,t.path)(s,o.tree),p=(0,e.typeOf)(i["@value"]);if("object"!=p&&"array"!=p)throw new Error("add/1 neither an object nor an array: "+r);if("array"==p){const e="-"===u?i["@value"].length:u;if("number"!=typeof e||e%1!=0)throw new Error("add/2 invalid index: "+r);if(e<0||e>i["@value"].length)throw new Error("add/3 index out of range: "+r);const a=f(n),p=(0,t.insert)(e,a,i["@value"]),l=d(p),h=(0,t.assocPath)(s,l,o.tree),v=o.trackUpdate?x(o.updatePoint,s):o.updatePoint;return c(c({},o),{},{tree:h,updatePoint:v})}{if("string"!=typeof u)throw new Error("add/4 invalid name: "+r);const e=f(n),p=c(c({},i["@value"]),{},{[u]:e}),l=d(p),h=(0,t.assocPath)(s,l,o.tree),v=o.trackUpdate?x(o.updatePoint,u in i["@value"]?a:s):o.updatePoint;return c(c({},o),{},{tree:h,updatePoint:v})}};exports.add=k;const S=(r,n)=>{const o=y(r),a=l(o),s=(0,t.last)(o),u=(0,t.path)(a,n.tree),i=(0,e.typeOf)(u["@value"]);if("object"!=i&&"array"!=i)throw new Error("remove/1 neither an object nor an array: "+r);if("array"==i){if("number"!=typeof s||s%1!=0)throw new Error("remove/2 invalid index: "+r);if(s<0||s>=u["@value"].length)throw new Error("remove/3 out of range: "+r);const e=(0,t.remove)(s,1,u["@value"]),o=d(e),i=(0,t.assocPath)(a,o,n.tree),p=n.trackUpdate?x(n.updatePoint,a):n.updatePoint;return c(c({},n),{},{tree:i,updatePoint:p})}{if(!u["@value"].hasOwnProperty(s))throw new Error("remove/4: property not found: "+r);const e=(0,t.dissoc)(s,u["@value"]),o=d(e),i=(0,t.assocPath)(a,o,n.tree),p=n.trackUpdate?x(n.updatePoint,a):n.updatePoint;return c(c({},n),{},{tree:i,updatePoint:p})}};exports.remove=S;const U=(r,n,o)=>{const a=y(r);if(0==a.length){const e=f(n),t=o.trackUpdate?[]:o.updatePoint;return c(c({},o),{},{tree:e,updatePoint:t})}const s=l(a),u=(0,t.last)(a),i=(0,t.path)(s,o.tree),p=(0,e.typeOf)(i["@value"]);if("object"!=p&&"array"!=p)throw new Error("replace/1 neither an object nor an array: "+r);if("array"==p){if("number"!=typeof u||u%1!=0)throw new Error("replace/2 invalid index: "+r);if(u<0||u>=i["@value"].length)throw new Error("replace/3 out of range: "+r);const e=f(n),p=(0,t.update)(u,e,i["@value"]),l=d(p),h=(0,t.assocPath)(s,l,o.tree),v=o.trackUpdate?x(o.updatePoint,a):o.updatePoint;return c(c({},o),{},{tree:h,updatePoint:v})}{if("string"!=typeof u)throw new Error("replace/4 invalid name: "+r);if(!(u in i["@value"]))throw new Error("replace/5 undefined property: "+r);const e=f(n),p=c(c({},i["@value"]),{},{[u]:e}),l=d(p),h=(0,t.assocPath)(s,l,o.tree),v=o.trackUpdate?x(o.updatePoint,a):o.updatePoint;return c(c({},o),{},{tree:h,updatePoint:v})}};exports.replace=U;const D=(e,t,r)=>{const n=O(e,r);return r=S(e,r),r=k(t,n,r)};exports.move=D;const T=(e,t,r)=>{const n=O(e,r);return r=k(t,n,r)};exports.copy=T;const R=(r,n)=>{let o=null;const a=t=>{const r=(0,e.appendPath)(o,t);return O(r,n)},s=(t,r,u)=>{const c=t["@value"];switch((0,e.typeOf)(c)){case"array":const i=[];for(let e=0;e<c.length;e++)i[e]=s(c[e],r+"/*",u+"/"+e);return o=u,n.validate(i,t,n.schemaDb[r],a);case"object":const p={};for(let e in c)p[e]=s(c[e],r+"/"+e,u+"/"+e);return o=u,n.validate(p,t,n.schemaDb[r],a);default:o=u;const l=n.validate(c,t,n.schemaDb[r],a);if(l["@value"]!==c)throw new Error("validate/0: value changed: "+u);return l}},u=y(r),i=(0,t.path)(u,n.tree);if(!i)throw new Error("validate/1: not found: "+r);const p=s(i,(0,e.normalizePath)(r),r),l=(0,t.assocPath)(u,p,n.tree);return c(c({},n),{},{tree:l})};exports.validate=R;const q=(r,n,o)=>{const a=(t,n)=>{const o=t["@value"];switch((0,e.typeOf)(o)){case"array":const s=[];for(let e=0;e<o.length;e++)s[e]=a(o[e],n+"/"+e);return c(c({},r(t,n)),{},{"@value":s});case"object":const u={};for(let e in o)u[e]=a(o[e],n+"/"+e);return c(c({},r(t,n)),{},{"@value":u});default:return c(c({},r(t,n)),{},{"@value":o})}},s=y(n),u=(0,t.path)(s,o.tree);if(!u)throw new Error("mapDeep/1: not found: "+n);const i=a(u,n),p=(0,t.assocPath)(s,i,o.tree);return c(c({},o),{},{tree:p})};exports.mapDeep=q;const I=(r,n,o,a)=>{const s=(t,n,o)=>{const a=n["@value"];switch((0,e.typeOf)(a)){case"array":for(let e=0;e<a.length;e++)t=s(t,a[e],o+"/"+e);return r(t,n,o);case"object":for(let e in a)t=s(t,a[e],o+"/"+e);return r(t,n,o);default:return r(t,n,o)}},u=y(o),c=(0,t.path)(u,a.tree);if(!c)throw new Error("reduceDeep/1: not found: "+o);return s(n,c,o)};exports.reduceDeep=I;const N=(r,n,o)=>{const a=y(r);if(0==a.length){const e=n.tree,t=o.trackUpdate?[]:o.updatePoint;return c(c({},o),{},{tree:e,updatePoint:t})}const s=l(a),u=(0,t.last)(a),i=(0,t.path)(s,n.tree),p=(0,e.typeOf)(i["@value"]);if("object"!=p&&"array"!=p)throw new Error("duplicate/1 neither an object nor an array: "+r);if("array"==p){if("number"!=typeof u||u%1!=0)throw new Error("duplicate/2 invalid index: "+r);if(u<0||u>=i["@value"].length)throw new Error("duplicate/3 out of range: "+r);const e=i["@value"][u],n=(0,t.update)(u,e,i["@value"]),p=d(n),l=(0,t.assocPath)(s,p,o.tree),f=o.trackUpdate?x(o.updatePoint,a):o.updatePoint;return c(c({},o),{},{tree:l,updatePoint:f})}{if("string"!=typeof u)throw new Error("replace/4 invalid name: "+r);if(!(u in i["@value"]))throw new Error("replace/5 undefined property: "+r);const e=i["@value"][u],n=c(c({},i["@value"]),{},{[u]:e}),p=d(n),l=(0,t.assocPath)(s,p,o.tree),f=o.trackUpdate?x(o.updatePoint,a):o.updatePoint;return c(c({},o),{},{tree:l,updatePoint:f})}};exports.duplicate=N;const _=(e,t,r)=>{if(null===t){const t=r.extra,{[e]:o}=t,s=n(t,[e].map(a));return c(c({},r),{},{extra:s})}{const n=c(c({},r.extra),{},{[e]:t});return c(c({},r),{},{extra:n})}};exports.setExtra=_;const z=(e,t)=>t.extra[e]||null;exports.getExtra=z;const J=(e,t,o)=>{if(e)return c(c({},o),{},{ret:e,onPromiseThen:t});const{ret:a,onPromiseThen:s}=o;return n(o,r)};exports.setPortal=J;const M=e=>{if(!e.ret)throw new Error("doReturn/0: no ret");e.ret(e)};exports.doReturn=M;const A=e=>null!=e&&"object"==typeof e&&"tree"in e;exports.isEnv=A;
},{"./utils":"A5ip"}],"Vclz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.validate=exports.defaultRules=exports.coerce=exports.buildDb=exports.applyRules=void 0;var e=require("./utils");function r(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function t(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach(function(r){n(e,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(o,r))})}return e}function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}const o=e=>{if(!e)return!0;const r=e.charAt(e.length-1);return"null"==e||"?"==r},i=e=>{const r={},t=(e,n)=>{switch(r[n]=e,e.type){case"object":case"object?":for(let r in e.properties)t(e.properties[r],n+"/"+r);break;case"array":case"array?":t(e.items,n+"/*")}};return t(e,""),r};exports.buildDb=i;const u=(e,r)=>{if(!r)return!0;if(null===e)return o(r);switch(r){case"null":return!1;case"number":case"number?":return"number"==typeof e;case"integer":case"integer?":return"number"==typeof e&&e%1==0;case"boolean":case"boolean?":return"boolean"==typeof e;case"string":return"string"==typeof e;case"object":case"object?":return"object"==typeof e&&null!==e;case"array":case"array?":return Array.isArray(e);default:throw new Error("unknown type: "+r)}},a={type:(e,r)=>{if("string"!=typeof e)throw new Error("invalid type");return!!u(r,e)||{code:"type."+e}},enum:(e,r)=>{if(!Array.isArray(e))throw new Error("invalid parameter");for(let t=0;t<e.length;t++)if(e[t]===r)return!0;return{code:"rule.enum"}},const:(r,t)=>{if(r===t)return!0;switch((0,e.typeOf)(r)){case"string":case"number":case"null":case"boolean":return{code:"rule.const",hint:r};default:return{code:"rule.const.nohint"}}},notEmpty:(r,t)=>"string"!=(0,e.typeOf)(t)||(""!==t||{code:"rule.notEmpty"}),required:(r,t)=>{if(!Array.isArray(r))throw new Error("invalid parameter");if("object"!=(0,e.typeOf)(t))return!0;for(let e=0;e<r.length;e++)if(!t.hasOwnProperty(r[e]))return{code:"rule.required",hint:r[e]};return!0},switchRequired:(r,t,n)=>{if("object"!=(0,e.typeOf)(r)||!("tagProperty"in r))throw new Error("invalid parameter");if("object"!=(0,e.typeOf)(t))return!0;const o=n("0/"+r.tagProperty);if(!o)return{code:"rule.switchRequired.nohint",decription:"no tag"};if(!r.types[o])return{code:"rule.switchRequired.nohint",detail:"no type"};const i=r.types[o];if(!Array.isArray(i))throw new Error("invalid parameter");for(let e=0;e<i.length;e++)if(!t.hasOwnProperty(i[e]))return{code:"rule.switchRequired",hint:i[e]};return!0},same:(r,t,n)=>{if("string"!=typeof r)throw new Error("invalid parameter");const o=n(r);if(o!==t)switch((0,e.typeOf)(o)){case"string":case"number":case"null":case"boolean":return{code:"rule.same",hint:o};default:return{code:"rule.same.nohint"}}return!0},if:(r,t,n,o)=>{if("array"!=(0,e.typeOf)(r))throw new Error("invalid parameter");const[i,u,a,c={}]=r;if(!i||!u||!a)throw new Error("invalid parameter");const l=n(i),p=s(l,u,n,o);return s(t,!0===p?a:c,n,o)},multipleOf:(e,r)=>{if("number"!=typeof e)throw new Error("invalid parameter");return"number"!=typeof r||(r%e==0||{code:"rule.multipleOf",hint:e})},maximum:(e,r)=>"number"!=typeof r||(e>=r||{code:"rule.maximum",hint:e}),exclusiveMaximum:(e,r)=>"number"!=typeof r||(e>r||{code:"rule.exclusiveMaximum",hint:e}),minimum:(e,r)=>"number"!=typeof r||(e<=r||{code:"rule.minimum",hint:e}),exclusiveMinimum:(e,r)=>"number"!=typeof r||(e<r||{code:"rule.exclusiveMinimum",hint:e}),maxLength:(e,r)=>"string"!=typeof r||(r.length<=e||{code:"rule.maxLength",hint:e}),minLength:(e,r)=>"string"!=typeof r||(r.length>=e||{code:"rule.minLength",hint:e}),pattern:(e,r)=>{if("string"!=typeof e)throw new Error("invalid parameter");return"string"!=typeof r||(!!new RegExp(e).test(r)||{code:"rule.pattern",hint:e})},maxItems:(e,r)=>{if("number"!=typeof e)throw new Error("invalid parameter");return!Array.isArray(r)||(r.length<=e||{code:"rule.maxItems",hint:e})},minItems:(e,r)=>{if("number"!=typeof e)throw new Error("invalid parameter");return!Array.isArray(r)||(r.length>=e||{code:"rule.minItems",hint:e})}};exports.defaultRules=a;const c=r=>(n,o,i,u)=>{if(!(0,e.isJsonValue)(n)){if(i&&i.type){const e={code:"type."+i.type,detail:"given value: "+n};return t(t({},o),{},{"@value":n,invalid:!0,error:e})}{const e={code:"value",detail:"given value: "+n};return t(t({},o),{},{"@value":n,invalid:!0,error:e})}}if(i){const e=s(n,i,u,r);if(!0!==e)return t(t({},o),{},{"@value":n,invalid:!0,error:e})}return t(t({},o),{},{"@value":n,invalid:!1,error:null})};exports.validate=c;const s=(e,r,t,n)=>{for(let o in r){const i=n[o];if(!i)continue;const u=i(r[o],e,t,n);if(!0!==u)return u}return!0};exports.applyRules=s;const l=(e,r,t)=>{if(e=""+e,!t)throw new Error("coerce/0: no schema");if(!t.type||"string"!=typeof t.type)throw new Error("coerce/1: type not specified");const n=t.type;if(-1==["null","boolean","boolean?","integer","integer?","number","number?","string"].indexOf(n))throw new Error("coerce/2: not a coercion enabled type: "+n);switch(n){case"null":break;case"number":case"number?":const t=+e;if(""+t===e)return{"@value":t,input:e,touched:r.touched};break;case"integer":case"integer?":const o=+e;if(""+o===e&&o%1==0)return{"@value":o,input:e,touched:r.touched};break;case"boolean":case"boolean?":if("true"===e||"false"===e)return{"@value":"true"===e,input:e,touched:r.touched};break;case"string":return{"@value":e,input:e,touched:r.touched}}return""==e&&o(n)?{"@value":null,input:e,touched:r.touched}:{input:e,touched:r.touched}};exports.coerce=l;
},{"./utils":"A5ip"}],"Gkli":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizeError=exports.isError=exports.defaultErrorMessages=void 0;var e=t(require("string-template"));function t(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const l=e=>"object"==typeof e&&null!=e&&"code"in e;exports.isError=l;const i=t=>r=>{const a=t[r.code]||t["detail"in r?"fallback":"fallback.nodetail"],l=(0,e.default)(a,r);return n(n({},r),{},{message:l})};exports.normalizeError=i;const o={fallback:"Error code:{code}; detail:{detail}","fallback.nodetail":"Error code:{code}",value:"Invalid value","type.null":"Please input a null value","type.boolean":"Please input a boolean value","type.boolean?":"Please input a boolean value or a null","type.integer":"Please input an integer","type.integer?":"Please input an integer or a null","type.number":"Please input a number","type.number?":"Please input a number or a null","type.string":"Please input a string","type.object":"Please input an object value","type.object?":"Please input an object value or a null","type.array":"Please input an array value","type.array?":"Please input an array value or a null","rule.enum":"Invalid input","rule.const":"Input {hint}","rule.const.nohint":"Invalid input","rule.notEmpty":"Please input","rule.required":'Missing property "{hint}"',"rule.switchRequired":'Missing property "{hint}"',"rule.switchRequired.nohint":"Properties are missing","rule.same":"Please input {hint}","rule.same.nohint":"Invalid input","rule.multipleOf":"Please enter a multiple of {hint}","rule.maximum":"Please enter {hint} or less","rule.exclusiveMaximum":"Please enter less than {hint}","rule.minimum":"Please enter {hint} or more","rule.exclusiveMinimum":"Please enter more than {hint}","rule.maxLength":"Please enter no more than {hint} characters","rule.minLength":"Please enter at least {hint} characters","rule.pattern":"Invalid format","rule.maxItems":"Please make it {hint} or less","rule.minItems":"Please make it {hint} or more","http.400":"HTTP error: {detail}","http:401":"HTTP error: {detail}","http:403":"HTTP error: {detail}","http.404":"HTTP error: {detail}","http.405":"HTTP error: {detail}","http.406":"HTTP error: {detail}","http.407":"HTTP error: {detail}","http.408":"HTTP error: {detail}","http.409":"HTTP error: {detail}","http.410":"HTTP error: {detail}","http.500":"HTTP error: {detail}","http.501":"HTTP error: {detail}","http.502":"HTTP error: {detail}","http.503":"HTTP error: {detail}"};exports.defaultErrorMessages=o;
},{}],"EhLI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.start=exports.once=exports.h=exports.API=void 0;var e=require("./utils"),t=l(require("./env")),r=l(require("./schema")),a=l(require("./errors")),n=require("hyperapp");function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var s=n?Object.getOwnPropertyDescriptor(e,l):null;s&&(s.get||s.set)?Object.defineProperty(a,l,s):a[l]=e[l]}return a.default=e,r&&r.set(e,a),a}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){i(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c={test:t.test,extract:t.extract,getSlot:t.getSlot,add:t.add,remove:t.remove,replace:t.replace,move:t.move,copy:t.copy,duplicate:t.duplicate,validate:t.validate,mapDeep:t.mapDeep,reduceDeep:t.reduceDeep,getExtra:t.getExtra,touchAll:(e,r)=>t.mapDeep((e,t)=>u(u({},e),{},{touched:!0}),e,r),countValidationErrors:(e,r)=>t.reduceDeep((e,t,r)=>{return e+(t.touched&&t.invalid?1:0)},0,e,r),validationErrors:(e,r)=>{const a=[];return t.reduceDeep((e,t,r)=>(t.touched&&t.invalid&&a.push(r),null),null,e,r),a},foldValidity:(e,t)=>c.reduceDeep((e,t,r)=>e.invalid?e:t.touched&&t.invalid?{invalid:!0,error:t.error}:e,{invalid:!1,error:null},e,t),sleep:(e,t)=>{return[new Promise((t,r)=>{setTimeout(()=>{t(null)},e)}),t]},startReordering:(e,r,a,n)=>{return[new Promise((o,l)=>{n=t.setExtra(e,{itemPath:r,group:a,fulfill:o,reject:l},n)}),n]},endReordering:(e,r)=>{return t.getExtra(e,r)?t.setExtra(e,null,r):r},getReordering:(e,r)=>{const a=t.getExtra(e,r);return a?a.itemPath:null},openDialog:(e,r,a)=>{return[new Promise((n,o)=>{a=t.setExtra(e,{data:r,fulfill:n,reject:o},a)}),a]},closeDialog:(e,r)=>{return t.getExtra(e,r)?t.setExtra(e,null,r):r},getDialog:(e,r)=>{const a=t.getExtra(e,r);return a?a.data:null},openFeedback:(e,r,a)=>t.setExtra(e,r,a),closeFeedback:(e,r)=>{return t.getExtra(e,r)?t.setExtra(e,null,r):r},getFeedback:(e,r)=>t.getExtra(e,r),setPage:(e,r,a)=>t.setExtra(e,r,a),getPage:(e,r)=>{const a=t.getExtra(e,r);return null!==a?a:0},nextPage:(e,r)=>{const a=t.getExtra(e,r),n=null!==a?a:0;return t.setExtra(e,n+1,r)},prevPage:(e,r)=>{const a=t.getExtra(e,r),n=null!==a?a:0;return t.setExtra(e,n-1,r)},setSwitch:(e,r,a)=>t.setExtra(e,r,a),getSwitch:(e,r)=>{const a=t.getExtra(e,r);return null!==a&&a},toggleSwitch:(e,r)=>{const a=t.getExtra(e,r),n=null!==a&&a;return t.setExtra(e,!n,r)},openProgress:(e,r,a)=>t.setExtra(e,{current:-1},a),closeProgress:(e,r)=>t.setExtra(e,null,r),getProgress:(e,r)=>{const a=t.getExtra(e,r);return a?a.current:null},reorder:(e,t,r,a)=>{const{enter:n,leave:o}=c.makePortal(a);return o(c.startReordering(e,t,r,a)).then(n(({path:r},a)=>(a=c.endReordering(e,a),c.move(t,r,a))))},makePortal:e=>({enter:t=>r=>{let a=null;return e.onPromiseThen({result:r,handler:t,ret:e=>{a=e}}),a},leave:(e,r)=>{const a=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[1]:r;if(!t.isEnv(n))throw new Error("exit/1: env required");return t.doReturn(n),a}})};exports.API=c;const g={openDialog:c.openDialog,closeDialog:c.closeDialog,openFeedback:c.openFeedback,closeFeedback:c.closeFeedback,openProgress:c.openProgress,closeProgress:c.closeProgress,setPage:c.setPage,nextPage:c.nextPage,prevPage:c.prevPage,setSwitch:c.setSwitch,toggleSwitch:c.toggleSwitch,reorder:c.reorder},d=({data:o,schema:l,view:s,containerEl:i,evolve:c=null,updates:d={},rules:p=null,catalog:v=null})=>{c||(c=((e,t,r)=>e));const b=r.validate(p||r.defaultRules),E=r.coerce,h=a.normalizeError(v||a.defaultErrorMessages),m=r.buildDb(l),P={onTextboxInput:e=>(r,a)=>{const n=e.currentTarget.dataset.mgPath,o=e.currentTarget[e.currentTarget.dataset.mgValueAttribute],l=u(u({},t.getSlot(n,r.baseEnv)),{},{input:o}),s=t.setSlot(n,l,r.baseEnv),i=u(u({},t.getSlot(n,r.env)),{},{input:o}),c=t.setSlot(n,i,r.env);return u(u({},r),{},{baseEnv:s,env:c})},onTextboxBlur:r=>(a,n)=>{const o=r.currentTarget.dataset.mgPath,l=r.currentTarget[r.currentTarget.dataset.mgValueAttribute],s=(0,e.normalizePath)(o),i=u(u({},t.getSlot(o,a.baseEnv)),{},{touched:!0}),g=E(l,i,m[s]);let d,p=t.beginUpdateTracking(a.baseEnv);p=t.setSlot(o,g,p),p=t.validate("",p),[d,p]=t.endUpdateTracking(p);let v=c(p,d,p);return v=t.validate("",v),u(u({},a),{},{baseEnv:p,env:v})},onSliderInput:e=>(r,a)=>{const n=e.currentTarget.dataset.mgPath,o=e.currentTarget[e.currentTarget.dataset.mgValueAttribute],l=u(u({},t.getSlot(n,r.baseEnv)),{},{input:o}),s=t.setSlot(n,l,r.baseEnv),i=u(u({},t.getSlot(n,r.env)),{},{input:o}),c=t.setSlot(n,i,r.env);return u(u({},r),{},{baseEnv:s,env:c})},onSliderChange:r=>(a,n)=>{const o=r.currentTarget.dataset.mgPath,l=r.currentTarget[r.currentTarget.dataset.mgValueAttribute],s=(0,e.normalizePath)(o),i=u(u({},t.getSlot(o,a.baseEnv)),{},{touched:!0}),g=E(l,i,m[s]);let d,p=t.beginUpdateTracking(a.baseEnv);p=t.setSlot(o,g,p),p=t.validate("",p),[d,p]=t.endUpdateTracking(p);let v=c(p,d,a.env);return v=t.validate("",v),u(u({},a),{},{baseEnv:p,env:v})},onListboxChange:r=>(a,n)=>{const o=r.currentTarget.dataset.mgPath,l=r.currentTarget[r.currentTarget.dataset.mgValueAttribute],s=(0,e.normalizePath)(o),i=u(u({},t.getSlot(o,a.baseEnv)),{},{touched:!0}),g=E(l,i,m[s]);let d,p=t.beginUpdateTracking(a.baseEnv);p=t.setSlot(o,g,p),p=t.validate("",p),[d,p]=t.endUpdateTracking(p);let v=c(p,d,a.env);return v=t.validate("",v),u(u({},a),{},{baseEnv:p,env:v})},onRadioChange:r=>(a,n)=>{const o=r.currentTarget.dataset.mgPath,l=r.currentTarget[r.currentTarget.dataset.mgValueAttribute],s=(0,e.normalizePath)(o),i=u(u({},t.getSlot(o,a.baseEnv)),{},{touched:!0}),g=E(l,i,m[s]);let d,p=t.beginUpdateTracking(a.baseEnv);p=t.setSlot(o,g,p),p=t.validate("",p),[d,p]=t.endUpdateTracking(p);let v=c(p,d,a.env);return v=t.validate("",v),u(u({},a),{},{baseEnv:p,env:v})},onCheckboxChange:r=>(a,n)=>{const o=r.currentTarget.dataset.mgPath,l=r.currentTarget[r.currentTarget.dataset.mgCheckedAttribute]?"true":"false",s=(0,e.normalizePath)(o),i=u(u({},t.getSlot(o,a.baseEnv)),{},{touched:!0}),g=E(l,i,m[s]);let d,p=t.beginUpdateTracking(a.baseEnv);p=t.setSlot(o,g,p),p=t.validate("",p),[d,p]=t.endUpdateTracking(p);let v=c(p,d,a.env);return v=t.validate("",v),u(u({},a),{},{baseEnv:p,env:v})},onSmartControlChange:r=>(a,n)=>{const o=Array.isArray(r)?r:[r];let l,s=t.beginUpdateTracking(a.baseEnv);for(let r=0;r<o.length;r++){const{path:a,input:n}=o[r],l=u(u({},t.getSlot(a,s)),{},{touched:!0}),i=E(n,l,m[(0,e.normalizePath)(a)]);s=t.setSlot(a,i,s)}s=t.validate("",s),[l,s]=t.endUpdateTracking(s);let i=c(s,l,a.env);return i=t.validate("",i),u(u({},a),{},{baseEnv:s,env:i})},onUpdate:e=>(r,a)=>{const n="currentTarget"in e?e.currentTarget.dataset.mgUpdate:e.update,o="currentTarget"in e?JSON.parse(e.currentTarget.dataset.mgContext||"null"):e.context;let l,s=t.beginUpdateTracking(r.baseEnv);s=t.setPortal(e=>{s=e},a.onPromiseThen,s);const i=d[n]||g[n];if(!i)throw new Error("onUpdate/0: no update or unknown update");if(!Array.isArray(o))throw new Error("onUpdate/1: parameter must be an array");if(o.length+1!=i.length)throw new Error("onUpdate/2: bad number of parameters");const p=i.apply(null,[...o,s]);s=t.setPortal(null,null,t.isEnv(p)?p:s),s=t.validate("",s),[l,s]=t.endUpdateTracking(s);let v=r.env;return t.isSame(r.baseEnv,s)||(v=c(s,l,v),v=t.validate("",v)),u(u({},r),{},{baseEnv:s,env:v})},onPromiseSettle:e=>(r,a)=>{const n="currentTarget"in e?e.currentTarget.dataset.mgName:e.name,o="currentTarget"in e?JSON.parse(e.currentTarget.dataset.mgResult||"null"):e.result,l=t.getExtra(n,r.baseEnv);if(!l||!l.fulfill)throw new Error("onPromiseSettle/0: no callback or unknown callback");return setTimeout(()=>{l.fulfill(o)},0),null},onPromiseThen:e=>(r,a)=>{let n,o=t.beginUpdateTracking(r.baseEnv);o=t.setPortal(e=>{o=e},a.onPromiseThen,o);const l=e.handler(e.result,o);o=t.setPortal(null,null,t.isEnv(l)?l:o),o=t.validate("",o),[n,o]=t.endUpdateTracking(o);let s=r.env;return t.isSame(r.baseEnv,o)||(s=c(o,n,s),s=t.validate("",s)),t.isEnv(l)||e.ret(l),u(u({},r),{},{baseEnv:o,env:s})}};let f,T=t.makeEnv(o,m,b,!0);T=t.validate("",T),[f,T]=t.endUpdateTracking(T);let x=c(T,f,null);const S={baseEnv:T,env:x=t.validate("",x),normalizeError:h};return{onUpdate:(0,n.app)(S,P,(e,t)=>s(e.env),i).onUpdate}};exports.start=d;const p=({data:e,schema:a,evolve:n=null,rules:o=null})=>{n||(n=((e,t,r)=>e));const l=r.validate(o||r.defaultRules),s=r.buildDb(a);let u,i=t.makeEnv(e,s,l,!0);i=t.validate("",i),[u,i]=t.endUpdateTracking(i);let c=n(i,u,null);return c=t.validate("",c)};exports.once=p;const v=n.h;exports.h=v;
},{"./utils":"A5ip","./env":"c6ur","./schema":"Vclz","./errors":"Gkli"}],"ZHjh":[function(require,module,exports) {
"use strict";var e=require("../../src/core/framework");function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function r(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const n={frame:[{name:"SC130-T",price:32e3}],os:[{name:"Home",price:8e3},{name:"Pro",price:13e3}],cpu:[{name:"i7",price:24e3},{name:"i5",price:16e3},{name:"i3",price:1e4}],memory:[{name:"4G",price:1e4},{name:"8G",price:2e4},{name:"16G",price:4e4},{name:"32G",price:8e4}],accessory:[{name:"Keyboard",price:2e3},{name:"Mouse",price:2e3},{name:"Touch Pad",price:2e3},{name:"Monitor",price:2e4}],bonus:[{name:"Mobile Wi-Fi Adaptor",price:0},{name:"Touchauth Component",price:0}]},a={type:"object",properties:{detail:{type:"object",properties:{frame:{type:"string",notEmpty:!0},os:{type:"string",notEmpty:!0},cpu:{type:"string",notEmpty:!0},memory:{type:"string",notEmpty:!0},accessories:{type:"object",properties:n.accessory.reduce((e,t,o)=>r(r({},e),{},{[`a${o}`]:{type:"boolean"}}),{})},bonus:{type:"string",notEmpty:!0}}},flags:{type:"object",properties:{isPro:{type:"boolean"},bigDeal:{type:"boolean"}}},quotation:{type:"object",properties:{lines:{type:"array",items:{type:"object",properties:{category:{type:"string"},description:{type:"string"},unitPrice:{type:"integer"},quantity:{type:"integer"},amount:{type:"integer"}}}},subtotal:{type:"integer"},tax:{type:"integer"},total:{type:"integer"}}}}},i={detail:{frame:"SC130-T",os:"Pro",cpu:"i5",memory:"16G",accessories:{a0:!1,a1:!1,a2:!0,a3:!1},bonus:"Touchauth Component"},flags:{isPro:!1,bigDeal:!1},quotation:{lines:[],subtotal:0,tax:0,total:0}},c=(e,t,r)=>{for(let o=0;o<r.length;o++)if(r[o][e]==t)return r[o]},p=(t,r,o)=>{const a=(t,r,o)=>{const n={category:t,description:r.name,unitPrice:r.price,quantity:1,amount:r.price};return e.API.add("/quotation/lines/-",n,o)};let i=0,p=!1,s=e.API.extract("/detail",t);if(s.frame){const e=c("name",s.frame,n.frame);t=a("筐体",e,t),i+=e.price}if(s.os){const e=c("name",s.os,n.os);t=a("OS",e,t),i+=e.price,"Pro"==e.name&&(p=!0)}if(s.cpu){const e=c("name",s.cpu,n.cpu);t=a("CPU",e,t),i+=e.price}if(t=e.API.add("/flags/isPro",p,t),!p&&s.memory&&"32G"==s.memory&&(t=e.API.add("/detail/memory","",t),s=e.API.extract("/detail",t)),s.memory){const e=c("name",s.memory,n.memory);t=a("メモリ",e,t),i+=e.price}n.accessory.forEach((e,r)=>{s.accessories[`a${r}`]&&(t=a("アクセサリ",e,t),i+=e.price)});const m=i>=7e4;if(t=e.API.add("/flags/bigDeal",m,t),m||(t=e.API.remove("/detail/bonus",t),s=e.API.extract("/detail",t)),s.bonus){const e=c("name",s.bonus,n.bonus);t=a("ボーナス",e,t),i+=e.price}return t=e.API.add("/quotation/subtotal",i,t),t=e.API.add("/quotation/tax",i/10,t),t=e.API.add("/quotation/total",i+i/10,t)};let s=(0,e.once)({schema:a,data:i,evolve:p});s=e.API.touchAll("",s),s=e.API.validate("",s);const m=e.API.countValidationErrors("",s);if(m)console.error("ERROR: some validation errors occurred",s.tree);else{const t=e.API.extract("",s);console.log("SUCCESS",t)}
},{"../../src/core/framework":"EhLI"}]},{},["ZHjh"], null)
//# sourceMappingURL=/index.js.map