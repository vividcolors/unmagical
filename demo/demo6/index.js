parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"vZqM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.normalizeQuery=exports.commonPath=exports.isJsonValue=exports.emptyArray=exports.emptyObject=exports.typeOf=exports.pathToArray=exports.normalizePathArray=exports.appendPath=exports.normalizePath=exports.isIntStr=void 0;var r=function(r){var t=+r;return t%1==0&&r===""+t};exports.isIntStr=r;var t=function(r){for(var t=r.split("/"),e=1;e<t.length;e++)(0,exports.isIntStr)(t[e])&&(t[e]="*");return t.join("/")};exports.normalizePath=t;var e=function(r,t){if(""==t.charAt(0)||"/"==t.charAt(0))return t;if("0"===t)return r;var e=(0,exports.pathToArray)(r),n=t.split("/"),a=[],o=+n[0];return o>(a=e).length&&(o=a.length),a.splice(a.length-o,o),n.shift(),0==n.length&&0==a.length?"":"/"+a.concat(n).join("/")};exports.appendPath=e;var n=function(r){for(var t="",e=0;e<r.length;e++)"number"==typeof r[e]||(0,exports.isIntStr)(r[e])?t+="/*":t+="/"+r[e];return t};exports.normalizePathArray=n;var a=function(r){for(var t=r.split("/"),e=[],n=1;n<t.length;n++)e.push((0,exports.isIntStr)(t[n])?+t[n]:t[n]);return e};exports.pathToArray=a;var o=function(r){return null===r?"null":Array.isArray(r)?"array":typeof r};exports.typeOf=o,exports.emptyObject={},exports.emptyArray=[];var s=function(r){switch((0,exports.typeOf)(r)){case"null":case"number":case"boolean":case"string":case"object":case"array":return!0;default:return!1}};exports.isJsonValue=s;var p=function(r,t){for(var e=r.split("/"),n=t.split("/"),a=[],o=0;o<e.length&&!(n.length<=o)&&e[o]==n[o];o++)a.push(e[o]);return a.join("/")};exports.commonPath=p;var i=function(r,t){var e={};for(var n in r)switch((0,exports.typeOf)(n)){case"null":t||(e[n]="");break;case"boolean":e[n]=r[n]?"true":"false";break;case"number":e[n]=""+r[n];break;case"string":if(t&&""===r[n])break;e[n]=r[n]}return e};exports.normalizeQuery=i;
},{}],"bjtJ":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var r,t=1,a=arguments.length;t<a;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},r=this&&this.__rest||function(e,r){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)r.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(t[a[n]]=e[a[n]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.isEnv=exports.doReturn=exports.setPortal=exports.getExtra=exports.setExtra=exports.duplicate=exports.reduceDeep=exports.mapDeep=exports.validate=exports.copy=exports.move=exports.replace=exports.remove=exports.add=exports.setSlot=exports.getSlot=exports.extract=exports.test=exports.endUpdateTracking=exports.beginUpdateTracking=exports.isSame=exports.makeEnv=void 0;var t=require("./utils"),a=require("ramda"),n=function(e,r){return!e.length||(0,a.hasPath)(e,r)},o=function(e){return(0,a.init)((0,a.init)(e))},u=function(e){var r={value:e,invalid:!1,error:null};switch((0,t.typeOf)(e)){case"object":case"array":break;case"number":case"integer":r.input=""+e,r.touched=!1;break;case"boolean":r.input=e?"true":"false",r.touched=!1;break;case"null":r.input="",r.touched=!1;break;case"string":r.input=e,r.touched=!1}return r},i=function(e){var r=function(e){switch((0,t.typeOf)(e)){case"array":for(var a=[],n=0;n<e.length;n++)a[n]=r(e[n]);return u(a);case"object":var o={};for(var i in e)o[i]=r(e[i]);return u(o);default:return u(e)}};return r(e)},p=function(e){var r=e.value;switch((0,t.typeOf)(r)){case"array":for(var a=[],n=0;n<r.length;n++)a[n]=p(r[n]);return a;case"object":var o={};for(var u in r)o[u]=p(r[u]);return o;default:return r}},s=function(e,r,t,a){return{tree:i(e),trackUpdate:a,updatePoint:a?[]:null,schemaDb:r,validate:t,extra:{}}};exports.makeEnv=s;var c=function(e,r){return e.tree===r.tree&&e.extra===r.extra};exports.isSame=c;var l=function(e){for(var r=e.split("/"),a=[],n=1;n<r.length;n++)a.push("value"),a.push((0,t.isIntStr)(r[n])?+r[n]:r[n]);return a},v=function(e){for(var r="",t=0;t<e.length;t+=2)r+="/"+e[t+1];return r},d=function(e,r){if(null===e)return r;if(null===r)return e;for(var t=[],a=0;a<e.length&&!(a>=r.length)&&e[a+1]===r[a+1];a+=2)t.push(e[a]),t.push(e[a+1]);return t},f=function(r){return e(e({},r),{trackUpdate:!0})};exports.beginUpdateTracking=f;var h=function(r){var t=r.updatePoint?v(r.updatePoint):null;return console.log("update occurred at "+JSON.stringify(t)),[t,e(e({},r),{trackUpdate:!1,updatePoint:null})]};exports.endUpdateTracking=h;var x=function(e,r){return n(l(e),r.tree)};exports.test=x;var w=function(e,r){var t=l(e),n=(0,a.path)(t,r.tree);if(!n)throw new Error("extract/1: not found: "+e);return p(n)};exports.extract=w;var P=function(e,r){var t=l(e),n=(0,a.path)(t,r.tree);if(!n)throw new Error("getSlot/1: not found: "+e);return n};exports.getSlot=P;var y=function(r,n,o){var u=l(r),i=(0,a.path)(u,o.tree);if(!i)throw new Error("setSlot/1: not found: "+r);switch((0,t.typeOf)(i.value)){case"null":case"boolean":case"number":case"string":case"undefined":break;default:throw new Error("setSlot/2: not a scalar: "+r)}var p=(0,a.assocPath)(u,n,o.tree),s=o.trackUpdate?d(o.updatePoint,u):o.updatePoint;return e(e({},o),{tree:p,updatePoint:s})};exports.setSlot=y;var g=function(r,n,p){var s,c=l(r),v=o(c),f=(0,a.last)(c),h=(0,a.path)(v,p.tree),x=(0,t.typeOf)(h.value);if("object"!=x&&"array"!=x)throw new Error("add/1 neither an object nor an array: "+r);if("array"==x){var w="-"===f?h.value.length:f;if("number"!=typeof w||w%1!=0)throw new Error("add/2 invalid index: "+r);if(w<0||w>h.value.length)throw new Error("add/3 index out of range: "+r);var P=i(n),y=(0,a.insert)(w,P,h.value),g=u(y),b=(0,a.assocPath)(v,g,p.tree),m=p.trackUpdate?d(p.updatePoint,v):p.updatePoint;return e(e({},p),{tree:b,updatePoint:m})}if("string"!=typeof f)throw new Error("add/4 invalid name: "+r);P=i(n);var E=e(e({},h.value),((s={})[f]=P,s));g=u(E),b=(0,a.assocPath)(v,g,p.tree),m=p.trackUpdate?d(p.updatePoint,f in h.value?c:v):p.updatePoint;return e(e({},p),{tree:b,updatePoint:m})};exports.add=g;var b=function(r,n){var i=l(r),p=o(i),s=(0,a.last)(i),c=(0,a.path)(p,n.tree),v=(0,t.typeOf)(c.value);if("object"!=v&&"array"!=v)throw new Error("remove/1 neither an object nor an array: "+r);if("array"==v){if("number"!=typeof s||s%1!=0)throw new Error("remove/2 invalid index: "+r);if(s<0||s>=c.value.length)throw new Error("remove/3 out of range: "+r);var f=(0,a.remove)(s,1,c.value),h=u(f),x=(0,a.assocPath)(p,h,n.tree),w=n.trackUpdate?d(n.updatePoint,p):n.updatePoint;return e(e({},n),{tree:x,updatePoint:w})}if(!c.value.hasOwnProperty(s))throw new Error("remove/4: property not found: "+r);var P=(0,a.dissoc)(s,c.value);h=u(P),x=(0,a.assocPath)(p,h,n.tree),w=n.trackUpdate?d(n.updatePoint,p):n.updatePoint;return e(e({},n),{tree:x,updatePoint:w})};exports.remove=b;var m=function(r,n,p){var s,c=l(r);if(0==c.length){var v=i(n),f=p.trackUpdate?[]:p.updatePoint;return e(e({},p),{tree:v,updatePoint:f})}var h=o(c),x=(0,a.last)(c),w=(0,a.path)(h,p.tree),P=(0,t.typeOf)(w.value);if("object"!=P&&"array"!=P)throw new Error("replace/1 neither an object nor an array: "+r);if("array"==P){if("number"!=typeof x||x%1!=0)throw new Error("replace/2 invalid index: "+r);if(x<0||x>=w.value.length)throw new Error("replace/3 out of range: "+r);var y=i(n),g=(0,a.update)(x,y,w.value),b=u(g);v=(0,a.assocPath)(h,b,p.tree),f=p.trackUpdate?d(p.updatePoint,c):p.updatePoint;return e(e({},p),{tree:v,updatePoint:f})}if("string"!=typeof x)throw new Error("replace/4 invalid name: "+r);if(!(x in w.value))throw new Error("replace/5 undefined property: "+r);y=i(n);var m=e(e({},w.value),((s={})[x]=y,s));b=u(m),v=(0,a.assocPath)(h,b,p.tree),f=p.trackUpdate?d(p.updatePoint,c):p.updatePoint;return e(e({},p),{tree:v,updatePoint:f})};exports.replace=m;var E=function(e,r,t){var a=(0,exports.extract)(e,t);return t=(0,exports.remove)(e,t),t=(0,exports.add)(r,a,t)};exports.move=E;var O=function(e,r,t){var a=(0,exports.extract)(e,t);return t=(0,exports.add)(r,a,t)};exports.copy=O;var k=function(r,n){var o=null,u=function(e){var r=(0,t.appendPath)(o,e);return(0,exports.extract)(r,n)},i=function(e,r,a){var p=e.value;switch((0,t.typeOf)(p)){case"array":for(var s=[],c=0;c<p.length;c++)s[c]=i(p[c],r+"/*",a+"/"+c);return o=a,n.validate(s,e,n.schemaDb[r],u);case"object":var l={};for(var v in p)l[v]=i(p[v],r+"/"+v,a+"/"+v);return o=a,n.validate(l,e,n.schemaDb[r],u);default:o=a;var d=n.validate(p,e,n.schemaDb[r],u);if(d.value!==p)throw new Error("validate/0: value changed: "+a);return d}},p=l(r),s=(0,a.path)(p,n.tree);if(!s)throw new Error("validate/1: not found: "+r);var c=i(s,(0,t.normalizePath)(r),r),v=(0,a.assocPath)(p,c,n.tree);return e(e({},n),{tree:v})};exports.validate=k;var j=function(r,n,o){var u=function(a,n){var o=a.value;switch((0,t.typeOf)(o)){case"array":for(var i=[],p=0;p<o.length;p++)i[p]=u(o[p],n+"/"+p);return e(e({},r(a,n)),{value:i});case"object":var s={};for(var c in o)s[c]=u(o[c],n+"/"+c);return e(e({},r(a,n)),{value:s});default:return e(e({},r(a,n)),{value:o})}},i=l(n),p=(0,a.path)(i,o.tree);if(!p)throw new Error("mapDeep/1: not found: "+n);var s=u(p,n),c=(0,a.assocPath)(i,s,o.tree);return e(e({},o),{tree:c})};exports.mapDeep=j;var U=function(e,r,n,o){var u=function(r,a,n){var o=a.value;switch((0,t.typeOf)(o)){case"array":for(var i=0;i<o.length;i++)r=u(r,o[i],n+"/"+i);return e(r,a,n);case"object":for(var p in o)r=u(r,o[p],n+"/"+p);return e(r,a,n);default:return e(r,a,n)}},i=l(n),p=(0,a.path)(i,o.tree);if(!p)throw new Error("reduceDeep/1: not found: "+n);return u(r,p,n)};exports.reduceDeep=U;var S=function(r,n,i){var p,s=l(r);if(0==s.length){var c=n.tree,v=i.trackUpdate?[]:i.updatePoint;return e(e({},i),{tree:c,updatePoint:v})}var f=o(s),h=(0,a.last)(s),x=(0,a.path)(f,n.tree),w=(0,t.typeOf)(x.value);if("object"!=w&&"array"!=w)throw new Error("duplicate/1 neither an object nor an array: "+r);if("array"==w){if("number"!=typeof h||h%1!=0)throw new Error("duplicate/2 invalid index: "+r);if(h<0||h>=x.value.length)throw new Error("duplicate/3 out of range: "+r);var P=x.value[h],y=(0,a.update)(h,P,x.value),g=u(y);c=(0,a.assocPath)(f,g,i.tree),v=i.trackUpdate?d(i.updatePoint,s):i.updatePoint;return e(e({},i),{tree:c,updatePoint:v})}if("string"!=typeof h)throw new Error("replace/4 invalid name: "+r);if(!(h in x.value))throw new Error("replace/5 undefined property: "+r);P=x.value[h];var b=e(e({},x.value),((p={})[h]=P,p));g=u(b),c=(0,a.assocPath)(f,g,i.tree),v=i.trackUpdate?d(i.updatePoint,s):i.updatePoint;return e(e({},i),{tree:c,updatePoint:v})};exports.duplicate=S;var D=function(t,a,n){var o;if(null===a){var u=n.extra,i=t,p=(u[i],r(u,["symbol"==typeof i?i:i+""]));return e(e({},n),{extra:p})}p=e(e({},n.extra),((o={})[t]=a,o));return e(e({},n),{extra:p})};exports.setExtra=D;var T=function(e,r){return r.extra[e]||null};exports.getExtra=T;var _=function(t,a,n){if(t)return e(e({},n),{ret:t,onPromiseThen:a});n.ret,n.onPromiseThen;return r(n,["ret","onPromiseThen"])};exports.setPortal=_;var R=function(e){if(!e.ret)throw new Error("doReturn/0: no ret");e.ret(e)};exports.doReturn=R;var q=function(e){return null!=e&&"object"==typeof e&&"tree"in e};exports.isEnv=q;
},{"./utils":"vZqM"}],"sokK":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.coerce=exports.applyRules=exports.validate=exports.defaultRules=exports.buildDb=void 0;var r=require("./utils"),t=function(e){if(!e)return!0;var r=e.charAt(e.length-1);return"null"==e||"?"==r},n=function(e){var r={},t=function(e,n){switch(r[n]=e,e.type){case"object":case"object?":for(var i in e.properties)t(e.properties[i],n+"/"+i);break;case"array":case"array?":t(e.items,n+"/*")}};return t(e,""),r};exports.buildDb=n;var i=function(e,r){if(!r)return!0;if(null===e)return t(r);switch(r){case"null":return!1;case"number":case"number?":return"number"==typeof e;case"integer":case"integer?":return"number"==typeof e&&e%1==0;case"boolean":case"boolean?":return"boolean"==typeof e;case"string":return"string"==typeof e;case"object":case"object?":return"object"==typeof e&&null!==e;case"array":case"array?":return Array.isArray(e);default:throw new Error("unknown type: "+r)}};exports.defaultRules={type:function(e,r){if("string"!=typeof e)throw new Error("invalid type");return!!i(r,e)||{code:"type."+e}},enum:function(e,r){if(!Array.isArray(e))throw new Error("invalid parameter");for(var t=0;t<e.length;t++)if(e[t]===r)return!0;return{code:"rule.enum"}},const:function(e,t){if(e===t)return!0;switch((0,r.typeOf)(e)){case"string":case"number":case"null":case"boolean":return{code:"rule.const",hint:e};default:return{code:"rule.const.nohint"}}},notEmpty:function(e,t){return"string"!=(0,r.typeOf)(t)||(""!==t||{code:"rule.notEmpty"})},required:function(e,t){if(!Array.isArray(e))throw new Error("invalid parameter");if("object"!=(0,r.typeOf)(t))return!0;for(var n=0;n<e.length;n++)if(!t.hasOwnProperty(e[n]))return{code:"rule.required",hint:e[n]};return!0},switchRequired:function(e,t,n){if("object"!=(0,r.typeOf)(e)||!("tagProperty"in e))throw new Error("invalid parameter");if("object"!=(0,r.typeOf)(t))return!0;var i=n("0/"+(e=e).tagProperty);if(!i)return{code:"rule.switchRequired.nohint",decription:"no tag"};if(!e.types[i])return{code:"rule.switchRequired.nohint",detail:"no type"};var u=e.types[i];if(!Array.isArray(u))throw new Error("invalid parameter");for(var o=0;o<u.length;o++)if(!t.hasOwnProperty(u[o]))return{code:"rule.switchRequired",hint:u[o]};return!0},same:function(e,t,n){if("string"!=typeof e)throw new Error("invalid parameter");var i=n(e);if(i!==t)switch((0,r.typeOf)(i)){case"string":case"number":case"null":case"boolean":return{code:"rule.same",hint:i};default:return{code:"rule.same.nohint"}}return!0},if:function(e,t,n,i){if("array"!=(0,r.typeOf)(e))throw new Error("invalid parameter");var u=e,o=u[0],a=u[1],c=u[2],l=u[3],s=void 0===l?{}:l;if(!o||!a||!c)throw new Error("invalid parameter");var f=n(o);return!0===(0,exports.applyRules)(f,a,n,i)?(0,exports.applyRules)(t,c,n,i):(0,exports.applyRules)(t,s,n,i)},multipleOf:function(e,r){if("number"!=typeof e)throw new Error("invalid parameter");return"number"!=typeof r||(r%e==0||{code:"rule.multipleOf",hint:e})},maximum:function(e,r){return"number"!=typeof r||(e>=r||{code:"rule.maximum",hint:e})},exclusiveMaximum:function(e,r){return"number"!=typeof r||(e>r||{code:"rule.exclusiveMaximum",hint:e})},minimum:function(e,r){return"number"!=typeof r||(e<=r||{code:"rule.minimum",hint:e})},exclusiveMinimum:function(e,r){return"number"!=typeof r||(e<r||{code:"rule.exclusiveMinimum",hint:e})},maxLength:function(e,r){return"string"!=typeof r||(r.length<=e||{code:"rule.maxLength",hint:e})},minLength:function(e,r){return"string"!=typeof r||(r.length>=e||{code:"rule.minLength",hint:e})},pattern:function(e,r){if("string"!=typeof e)throw new Error("invalid parameter");return"string"!=typeof r||(!!new RegExp(e).test(r)||{code:"rule.pattern",hint:e})},maxItems:function(e,r){if("number"!=typeof e)throw new Error("invalid parameter");return!Array.isArray(r)||(r.length<=e||{code:"rule.maxItems",hint:e})},minItems:function(e,r){if("number"!=typeof e)throw new Error("invalid parameter");return!Array.isArray(r)||(r.length>=e||{code:"rule.minItems",hint:e})}};var u=function(t){return function(n,i,u,o){if(!(0,r.isJsonValue)(n)){if(u&&u.type){var a={code:"type."+u.type,detail:"given value: "+n};return e(e({},i),{value:n,invalid:!0,error:a})}a={code:"value",detail:"given value: "+n};return e(e({},i),{value:n,invalid:!0,error:a})}if(u){var c=(0,exports.applyRules)(n,u,o,t);if(!0!==c)return e(e({},i),{value:n,invalid:!0,error:c})}return e(e({},i),{value:n,invalid:!1,error:null})}};exports.validate=u;var o=function(e,r,t,n){for(var i in r){var u=n[i];if(u){var o=u(r[i],e,t,n);if(!0!==o)return o}}return!0};exports.applyRules=o;var a=function(e,r,n){if(e=""+e,!n)throw new Error("coerce/0: no schema");if(!n.type||"string"!=typeof n.type)throw new Error("coerce/1: type not specified");var i=n.type;if(-1==["null","boolean","boolean?","integer","integer?","number","number?","string"].indexOf(i))throw new Error("coerce/2: not a coercion enabled type: "+i);switch(i){case"null":break;case"number":case"number?":var u=+e;if(""+u===e)return{value:u,input:e,touched:r.touched};break;case"integer":case"integer?":var o=+e;if(""+o===e&&o%1==0)return{value:o,input:e,touched:r.touched};break;case"boolean":case"boolean?":if("true"===e||"false"===e)return{value:"true"===e,input:e,touched:r.touched};break;case"string":return{value:e,input:e,touched:r.touched}}return""==e&&t(i)?{value:null,input:e,touched:r.touched}:{input:e,touched:r.touched}};exports.coerce=a;
},{"./utils":"vZqM"}],"D0Z0":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var l in t=arguments[r])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.defaultErrorMessages=exports.normalizeError=exports.isError=void 0;var r=t(require("string-template")),a=function(e){return"object"==typeof e&&null!=e&&"code"in e};exports.isError=a;var l=function(t){return function(a){var l=t[a.code]||t["detail"in a?"fallback":"fallback.nodetail"],n=(0,r.default)(l,a);return e(e({},a),{message:n})}};exports.normalizeError=l,exports.defaultErrorMessages={fallback:"Error code:{code}; detail:{detail}","fallback.nodetail":"Error code:{code}",value:"Invalid value","type.null":"Please input a null value","type.boolean":"Please input a boolean value","type.boolean?":"Please input a boolean value or a null","type.integer":"Please input an integer","type.integer?":"Please input an integer or a null","type.number":"Please input a number","type.number?":"Please input a number or a null","type.string":"Please input a string","type.object":"Please input an object value","type.object?":"Please input an object value or a null","type.array":"Please input an array value","type.array?":"Please input an array value or a null","rule.enum":"Invalid input","rule.const":"Input {hint}","rule.const.nohint":"Invalid input","rule.notEmpty":"Please input","rule.required":'Missing property "{hint}"',"rule.switchRequired":'Missing property "{hint}"',"rule.switchRequired.nohint":"Properties are missing","rule.same":"Please input {hint}","rule.same.nohint":"Invalid input","rule.multipleOf":"Please enter a multiple of {hint}","rule.maximum":"Please enter {hint} or less","rule.exclusiveMaximum":"Please enter less than {hint}","rule.minimum":"Please enter {hint} or more","rule.exclusiveMinimum":"Please enter more than {hint}","rule.maxLength":"Please enter no more than {hint} characters","rule.minLength":"Please enter at least {hint} characters","rule.pattern":"Invalid format","rule.maxItems":"Please make it {hint} or less","rule.minItems":"Please make it {hint} or more","http.400":"HTTP error: {detail}","http:401":"HTTP error: {detail}","http:403":"HTTP error: {detail}","http.404":"HTTP error: {detail}","http.405":"HTTP error: {detail}","http.406":"HTTP error: {detail}","http.407":"HTTP error: {detail}","http.408":"HTTP error: {detail}","http.409":"HTTP error: {detail}","http.410":"HTTP error: {detail}","http.500":"HTTP error: {detail}","http.501":"HTTP error: {detail}","http.502":"HTTP error: {detail}","http.503":"HTTP error: {detail}"};
},{}],"Trba":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},t=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&t(n,e,a);return r(n,e),n},a=this&&this.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,a=0,u=t.length;a<u;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.h=exports.once=exports.start=exports.API=void 0;var u,o=require("./utils"),i=n(require("./env")),l=n(require("./schema")),c=n(require("./errors")),s=require("hyperapp");!function(t){t.test=i.test,t.extract=i.extract,t.getSlot=i.getSlot,t.add=i.add,t.remove=i.remove,t.replace=i.replace,t.move=i.move,t.copy=i.copy,t.duplicate=i.duplicate,t.validate=i.validate,t.mapDeep=i.mapDeep,t.reduceDeep=i.reduceDeep,t.getExtra=i.getExtra,t.touchAll=function(t,r){return i.mapDeep(function(t,r){return e(e({},t),{touched:!0})},t,r)},t.countValidationErrors=function(e,t){return i.reduceDeep(function(e,t,r){return e+(t.touched&&t.invalid?1:0)},0,e,t)},t.validationErrors=function(e,t){var r=[];return i.reduceDeep(function(e,t,n){return t.touched&&t.invalid&&r.push(n),null},null,e,t),r},t.foldValidity=function(e,r){return t.reduceDeep(function(e,t,r){return e.invalid?e:t.touched&&t.invalid?{invalid:!0,error:t.error}:e},{invalid:!1,error:null},e,r)},t.sleep=function(e,t){return[new Promise(function(t,r){setTimeout(function(){t(null)},e)}),t]},t.startReordering=function(e,t,r,n){return[new Promise(function(a,u){n=i.setExtra(e,{itemPath:t,group:r,fulfill:a,reject:u},n)}),n]},t.endReordering=function(e,t){return i.getExtra(e,t)?i.setExtra(e,null,t):t},t.getReordering=function(e,t){var r=i.getExtra(e,t);return r?r.itemPath:null},t.openDialog=function(e,t,r){return[new Promise(function(n,a){r=i.setExtra(e,{data:t,fulfill:n,reject:a},r)}),r]},t.closeDialog=function(e,t){return i.getExtra(e,t)?i.setExtra(e,null,t):t},t.getDialog=function(e,t){var r=i.getExtra(e,t);return r?r.data:null},t.openFeedback=function(e,t,r){return i.setExtra(e,t,r)},t.closeFeedback=function(e,t){return i.getExtra(e,t)?i.setExtra(e,null,t):t},t.getFeedback=function(e,t){return i.getExtra(e,t)},t.setPage=function(e,t,r){return i.setExtra(e,t,r)},t.getPage=function(e,t){var r=i.getExtra(e,t);return null!==r?r:0},t.nextPage=function(e,t){var r=i.getExtra(e,t),n=null!==r?r:0;return i.setExtra(e,n+1,t)},t.prevPage=function(e,t){var r=i.getExtra(e,t),n=null!==r?r:0;return i.setExtra(e,n-1,t)},t.setSwitch=function(e,t,r){return i.setExtra(e,t,r)},t.getSwitch=function(e,t){var r=i.getExtra(e,t);return null!==r&&r},t.toggleSwitch=function(e,t){var r=i.getExtra(e,t),n=null!==r&&r;return i.setExtra(e,!n,t)},t.openProgress=function(e,t,r){return i.setExtra(e,{current:-1},r)},t.closeProgress=function(e,t){return i.setExtra(e,null,t)},t.getProgress=function(e,t){var r=i.getExtra(e,t);return r?r.current:null},t.reorder=function(e,r,n,a){var u=t.makePortal(a),o=u.enter;return(0,u.leave)(t.startReordering(e,r,n,a)).then(o(function(n,a){var u=n.path;return a=t.endReordering(e,a),t.move(r,u,a)}))},t.makePortal=function(e){return{enter:function(t){return function(r){var n=null;return e.onPromiseThen({result:r,handler:t,ret:function(e){n=e}}),n}},leave:function(e,t){var r=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[1]:t;if(!i.isEnv(n))throw new Error("exit/1: env required");return i.doReturn(n),r}}}}(u=exports.API||(exports.API={}));var v={openDialog:u.openDialog,closeDialog:u.closeDialog,openFeedback:u.openFeedback,closeFeedback:u.closeFeedback,openProgress:u.openProgress,closeProgress:u.closeProgress,setPage:u.setPage,nextPage:u.nextPage,prevPage:u.prevPage,setSwitch:u.setSwitch,toggleSwitch:u.toggleSwitch,reorder:u.reorder},d=function(t){var r,n=t.data,u=t.schema,d=t.view,g=t.containerEl,f=t.evolve,p=void 0===f?null:f,h=t.updates,b=void 0===h?{}:h,E=t.rules,m=void 0===E?null:E,P=t.catalog,T=void 0===P?null:P;p||(p=function(e,t,r){return e});var x,S=l.validate(m||l.defaultRules),k=l.coerce,y=c.normalizeError(T||c.defaultErrorMessages),w=l.buildDb(u),U={onTextboxInput:function(t){return function(r,n){var a=t.currentTarget.dataset.mgPath,u=t.currentTarget[t.currentTarget.dataset.mgValueAttribute],o=i.getSlot(a,r.baseEnv),l=e(e({},o),{input:u}),c=i.setSlot(a,l,r.baseEnv),s=i.getSlot(a,r.env),v=e(e({},s),{input:u}),d=i.setSlot(a,v,r.env);return e(e({},r),{baseEnv:c,env:d})}},onTextboxBlur:function(t){return function(r,n){var a,u,l=t.currentTarget.dataset.mgPath,c=t.currentTarget[t.currentTarget.dataset.mgValueAttribute],s=(0,o.normalizePath)(l),v=e(e({},i.getSlot(l,r.baseEnv)),{touched:!0}),d=k(c,v,w[s]),g=i.beginUpdateTracking(r.baseEnv);g=i.setSlot(l,d,g),g=i.validate("",g),u=(a=i.endUpdateTracking(g))[0],g=a[1];var f=p(g,u,g);return f=i.validate("",f),e(e({},r),{baseEnv:g,env:f})}},onSliderInput:function(t){return function(r,n){var a=t.currentTarget.dataset.mgPath,u=t.currentTarget[t.currentTarget.dataset.mgValueAttribute],o=i.getSlot(a,r.baseEnv),l=e(e({},o),{input:u}),c=i.setSlot(a,l,r.baseEnv),s=i.getSlot(a,r.env),v=e(e({},s),{input:u}),d=i.setSlot(a,v,r.env);return e(e({},r),{baseEnv:c,env:d})}},onSliderChange:function(t){return function(r,n){var a,u,l=t.currentTarget.dataset.mgPath,c=t.currentTarget[t.currentTarget.dataset.mgValueAttribute],s=(0,o.normalizePath)(l),v=e(e({},i.getSlot(l,r.baseEnv)),{touched:!0}),d=k(c,v,w[s]),g=i.beginUpdateTracking(r.baseEnv);g=i.setSlot(l,d,g),g=i.validate("",g),u=(a=i.endUpdateTracking(g))[0],g=a[1];var f=p(g,u,r.env);return f=i.validate("",f),e(e({},r),{baseEnv:g,env:f})}},onListboxChange:function(t){return function(r,n){var a,u,l=t.currentTarget.dataset.mgPath,c=t.currentTarget[t.currentTarget.dataset.mgValueAttribute],s=(0,o.normalizePath)(l),v=e(e({},i.getSlot(l,r.baseEnv)),{touched:!0}),d=k(c,v,w[s]),g=i.beginUpdateTracking(r.baseEnv);g=i.setSlot(l,d,g),g=i.validate("",g),u=(a=i.endUpdateTracking(g))[0],g=a[1];var f=p(g,u,r.env);return f=i.validate("",f),e(e({},r),{baseEnv:g,env:f})}},onRadioChange:function(t){return function(r,n){var a,u,l=t.currentTarget.dataset.mgPath,c=t.currentTarget[t.currentTarget.dataset.mgValueAttribute],s=(0,o.normalizePath)(l),v=e(e({},i.getSlot(l,r.baseEnv)),{touched:!0}),d=k(c,v,w[s]),g=i.beginUpdateTracking(r.baseEnv);g=i.setSlot(l,d,g),g=i.validate("",g),u=(a=i.endUpdateTracking(g))[0],g=a[1];var f=p(g,u,r.env);return f=i.validate("",f),e(e({},r),{baseEnv:g,env:f})}},onCheckboxChange:function(t){return function(r,n){var a,u,l=t.currentTarget.dataset.mgPath,c=t.currentTarget[t.currentTarget.dataset.mgCheckedAttribute]?"true":"false",s=(0,o.normalizePath)(l),v=e(e({},i.getSlot(l,r.baseEnv)),{touched:!0}),d=k(c,v,w[s]),g=i.beginUpdateTracking(r.baseEnv);g=i.setSlot(l,d,g),g=i.validate("",g),u=(a=i.endUpdateTracking(g))[0],g=a[1];var f=p(g,u,r.env);return f=i.validate("",f),e(e({},r),{baseEnv:g,env:f})}},onSmartControlChange:function(t){return function(r,n){for(var a,u,l=Array.isArray(t)?t:[t],c=i.beginUpdateTracking(r.baseEnv),s=0;s<l.length;s++){var v=l[s],d=v.path,g=v.input,f=e(e({},i.getSlot(d,c)),{touched:!0}),h=k(g,f,w[(0,o.normalizePath)(d)]);c=i.setSlot(d,h,c)}c=i.validate("",c),u=(a=i.endUpdateTracking(c))[0],c=a[1];var b=p(c,u,r.env);return b=i.validate("",b),e(e({},r),{baseEnv:c,env:b})}},onUpdate:function(t){return function(r,n){var u,o,l="currentTarget"in t?t.currentTarget.dataset.mgUpdate:t.update,c="currentTarget"in t?JSON.parse(t.currentTarget.dataset.mgContext||"null"):t.context,s=i.beginUpdateTracking(r.baseEnv);s=i.setPortal(function(e){s=e},n.onPromiseThen,s);var d=b[l]||v[l];if(!d)throw new Error("onUpdate/0: no update or unknown update");if(!Array.isArray(c))throw new Error("onUpdate/1: parameter must be an array");if(c.length+1!=d.length)throw new Error("onUpdate/2: bad number of parameters");var g=d.apply(null,a(a([],c,!0),[s],!1));s=i.setPortal(null,null,i.isEnv(g)?g:s),s=i.validate("",s),o=(u=i.endUpdateTracking(s))[0],s=u[1];var f=r.env;return i.isSame(r.baseEnv,s)||(f=p(s,o,f),f=i.validate("",f)),e(e({},r),{baseEnv:s,env:f})}},onPromiseSettle:function(e){return function(t,r){var n="currentTarget"in e?e.currentTarget.dataset.mgName:e.name,a="currentTarget"in e?JSON.parse(e.currentTarget.dataset.mgResult||"null"):e.result,u=i.getExtra(n,t.baseEnv);if(!u||!u.fulfill)throw new Error("onPromiseSettle/0: no callback or unknown callback");return setTimeout(function(){u.fulfill(a)},0),null}},onPromiseThen:function(t){return function(r,n){var a,u,o=i.beginUpdateTracking(r.baseEnv);o=i.setPortal(function(e){o=e},n.onPromiseThen,o);var l=t.handler(t.result,o);o=i.setPortal(null,null,i.isEnv(l)?l:o),o=i.validate("",o),u=(a=i.endUpdateTracking(o))[0],o=a[1];var c=r.env;return i.isSame(r.baseEnv,o)||(c=p(o,u,c),c=i.validate("",c)),i.isEnv(l)||t.ret(l),e(e({},r),{baseEnv:o,env:c})}}},A=i.makeEnv(n,w,S,!0);A=i.validate("",A),x=(r=i.endUpdateTracking(A))[0],A=r[1];var D=p(A,x,null),_={baseEnv:A,env:D=i.validate("",D),normalizeError:y};return{onUpdate:(0,s.app)(_,U,function(e,t){return d(e.env)},g).onUpdate}};exports.start=d;var g=function(e){var t,r=e.data,n=e.schema,a=e.evolve,u=void 0===a?null:a,o=e.rules,c=void 0===o?null:o;u||(u=function(e,t,r){return e});var s,v=l.validate(c||l.defaultRules),d=l.buildDb(n),g=i.makeEnv(r,d,v,!0);g=i.validate("",g),s=(t=i.endUpdateTracking(g))[0];var f=u(g=t[1],s,null);return f=i.validate("",f)};exports.once=g,exports.h=s.h;
},{"./utils":"vZqM","./env":"bjtJ","./schema":"sokK","./errors":"D0Z0"}],"ZHjh":[function(require,module,exports) {
"use strict";var e=require("../../src/core/framework");function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function r(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?t(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const n={frame:[{name:"SC130-T",price:32e3}],os:[{name:"Home",price:8e3},{name:"Pro",price:13e3}],cpu:[{name:"i7",price:24e3},{name:"i5",price:16e3},{name:"i3",price:1e4}],memory:[{name:"4G",price:1e4},{name:"8G",price:2e4},{name:"16G",price:4e4},{name:"32G",price:8e4}],accessory:[{name:"Keyboard",price:2e3},{name:"Mouse",price:2e3},{name:"Touch Pad",price:2e3},{name:"Monitor",price:2e4}],bonus:[{name:"Mobile Wi-Fi Adaptor",price:0},{name:"Touchauth Component",price:0}]},a={type:"object",properties:{detail:{type:"object",properties:{frame:{type:"string",notEmpty:!0},os:{type:"string",notEmpty:!0},cpu:{type:"string",notEmpty:!0},memory:{type:"string",notEmpty:!0},accessories:{type:"object",properties:n.accessory.reduce((e,t,o)=>r(r({},e),{},{[`a${o}`]:{type:"boolean"}}),{})},bonus:{type:"string",notEmpty:!0}}},flags:{type:"object",properties:{isPro:{type:"boolean"},bigDeal:{type:"boolean"}}},quotation:{type:"object",properties:{lines:{type:"array",items:{type:"object",properties:{category:{type:"string"},description:{type:"string"},unitPrice:{type:"integer"},quantity:{type:"integer"},amount:{type:"integer"}}}},subtotal:{type:"integer"},tax:{type:"integer"},total:{type:"integer"}}}}},i={detail:{frame:"SC130-T",os:"Pro",cpu:"i5",memory:"16G",accessories:{a0:!1,a1:!1,a2:!0,a3:!1},bonus:"Touchauth Component"},flags:{isPro:!1,bigDeal:!1},quotation:{lines:[],subtotal:0,tax:0,total:0}},c=(e,t,r)=>{for(let o=0;o<r.length;o++)if(r[o][e]==t)return r[o]},p=(t,r,o)=>{const a=(t,r,o)=>{const n={category:t,description:r.name,unitPrice:r.price,quantity:1,amount:r.price};return e.API.add("/quotation/lines/-",n,o)};let i=0,p=!1,s=e.API.extract("/detail",t);if(s.frame){const e=c("name",s.frame,n.frame);t=a("筐体",e,t),i+=e.price}if(s.os){const e=c("name",s.os,n.os);t=a("OS",e,t),i+=e.price,"Pro"==e.name&&(p=!0)}if(s.cpu){const e=c("name",s.cpu,n.cpu);t=a("CPU",e,t),i+=e.price}if(t=e.API.add("/flags/isPro",p,t),!p&&s.memory&&"32G"==s.memory&&(t=e.API.add("/detail/memory","",t),s=e.API.extract("/detail",t)),s.memory){const e=c("name",s.memory,n.memory);t=a("メモリ",e,t),i+=e.price}n.accessory.forEach((e,r)=>{s.accessories[`a${r}`]&&(t=a("アクセサリ",e,t),i+=e.price)});const m=i>=7e4;if(t=e.API.add("/flags/bigDeal",m,t),m||(t=e.API.remove("/detail/bonus",t),s=e.API.extract("/detail",t)),s.bonus){const e=c("name",s.bonus,n.bonus);t=a("ボーナス",e,t),i+=e.price}return t=e.API.add("/quotation/subtotal",i,t),t=e.API.add("/quotation/tax",i/10,t),t=e.API.add("/quotation/total",i+i/10,t)};let s=(0,e.once)({schema:a,data:i,evolve:p});s=e.API.touchAll("",s),s=e.API.validate("",s);const m=e.API.countValidationErrors("",s);if(m)console.error("ERROR: some validation errors occurred",s.tree);else{const t=e.API.extract("",s);console.log("SUCCESS",t)}
},{"../../src/core/framework":"Trba"}]},{},["ZHjh"], null)
//# sourceMappingURL=/index.js.map